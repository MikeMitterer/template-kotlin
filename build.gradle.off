/* -------------------------------------------------------------------------------------------------
Update des Gradle-Wrappers
    VERSION=$(/usr/local/bin/gradle --version | grep -C 0 "Gradle " | sed "s/Gradle //"); \
    gradle wrapper --gradle-version "$VERSION"
*/

plugins {
    id "org.jetbrains.kotlin.jvm" version "1.2.51"  // Version: https://goo.gl/RriFBZ

    // [ Optional ]
    // Only if you use Artifactory - see below
    //id "com.jfrog.artifactory" version "4.6.2"      // Version: https://goo.gl/WjN2LZ
}

apply plugin: "java"
apply plugin: 'maven-publish' // Only if you want to publish to local Maven-Repo
apply plugin: 'kotlin'
apply plugin: "application"



// [ Optional ]
// Rename versions.gradle.optional to versions.gradle and include this file as below
// apply from: "versions.gradle"

version = "0.0.3"
group = "at.mikemitterer"
mainClassName = "at.mikemitterer.template.MainKt"

sourceSets {
    deploy
}

test {
    useJUnitPlatform()
}


dependencies {
    // Logging ---------------------------------------------------------------------------------------------------------
    implementation group: 'org.slf4j',                  name: 'slf4j-api',          version: version_slf4j

    implementation group: 'org.jetbrains.kotlin',       name: 'kotlin-stdlib-jdk8', version: version_kotlin
    //implementation group: 'org.jetbrains.kotlin', name: 'kotlin-reflect',      version: version_kotlin

    //implementation group: 'org.apache.commons', name: 'commons-lang3', version: version_commonsLang3

    // Test ------------------------------------------------------------------------------------------------------------
    testImplementation group: 'junit',                  name: 'junit',                      version: version_junit
    testImplementation group: 'ch.qos.logback', 	    name: 'logback-classic', 	        version: version_logback

    testImplementation group: 'org.jetbrains.kotlin',   name: 'kotlin-test-junit',          version: version_kotlin
    testImplementation group: 'io.kotlintest',          name: 'kotlintest-runner-junit5',   version: version_kotlinTest
}

// Publish to local Maven-Repo
// Usage:
//      gradle publishToMavenLocal
//
publishing {
    publications {
        maven(MavenPublication) {
            groupId = project.group
            artifactId = project.name.toLowerCase()
            version = project.version

            from components.java
        }
    }
}

repositories {
    // Migration from Maven to JCenter: https://goo.gl/d1zQT8
    jcenter()

    // Sollte eigentlich nicht ben√∂tigt werden
    // mavenLocal()

    // Artifactory / Nexus 3
    //      URL and Username / Password are defined in 
    //          ~/.gradle/gradle.properties
    //      (Must be set on your local machine (e.g. Mac and on your Jenkins-Server)

    // Uncomment this if you use Artifactory!!!
    // maven {
    //    url "${artifactory_url}/artifactory/libs-release-local/"
    //    credentials {
    //        username = "${artifactory_username}"
    //        password = "${artifactory_password}"
    //    }
    // }
}

//-------------------------------------------------------------------------------------------------
// Tasks

task deploy(
        group: "BuildDart",
        description: "Deploys this Lib",
        dependsOn: [
                jar,
                publishToMavenLocal /*uploadArchives*/
        ]
) {

    doLast {
        logger.lifecycle("Successfully deployed ${jar.baseName} - V ${version}")
    }
}

